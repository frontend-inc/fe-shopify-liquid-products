<section class="py-16">
  <div class="container mx-auto px-4">
    {% if title %}
      <h2 class="text-3xl font-heading font-semibold text-center mb-10">
        {{ title }}
      </h2>
    {% endif %}

    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      {% for product in products limit: 8 %}
        <article class="group relative">
          <a href="{{ product.url }}" class="block overflow-hidden rounded-lg bg-muted aspect-square">
            <img
              src="{{ product.featured_image | img_url: 'medium' }}"
              alt="{{ product.title | escape }}"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
              loading="lazy"
            >
          </a>

          {% if product.compare_at_price > product.price %}
            <span class="absolute top-2 left-2 bg-destructive text-destructive-foreground text-xs font-medium px-2 py-1 rounded-md">
              Sale
            </span>
          {% endif %}

          {% if product.available %}
            <button
              class="absolute bottom-2 right-2 bg-primary text-primary-foreground p-2 rounded-lg opacity-0 translate-y-2 transition-all duration-200 group-hover:opacity-100 group-hover:translate-y-0 hover:bg-primary/90"
              data-product-id="{{ product.variants.first.id }}"
              onclick="ShopifyAPI.addToCart(this.dataset.productId, 1)"
            >
              <i class="ri-add-line text-lg"></i>
            </button>
          {% endif %}

          <div class="mt-3 space-y-1">
            <h3 class="text-sm font-medium">
              <a href="{{ product.url }}" class="hover:underline">{{ product.title }}</a>
            </h3>
            <div class="flex items-center gap-2">
              <span class="text-sm font-semibold">{{ product.price | money }}</span>
              {% if product.compare_at_price > product.price %}
                <span class="text-sm text-muted-foreground line-through">{{ product.compare_at_price | money }}</span>
              {% endif %}
            </div>
          </div>
        </article>
      {% else %}
        <div class="col-span-full text-center py-10 text-muted-foreground">
          No products found
        </div>
      {% endfor %}
    </div>

    <div class="text-center mt-10">
      <a
        href="{{ collection_url | default: '/collections/all' }}"
        class="inline-flex items-center gap-2 bg-primary text-primary-foreground px-6 py-3 rounded-lg font-medium hover:bg-primary/90 transition-colors"
      >
        View All
        <i class="ri-arrow-right-line"></i>
      </a>
    </div>
  </div>
</section>
